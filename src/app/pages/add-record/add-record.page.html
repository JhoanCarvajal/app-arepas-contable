<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Agregar Registro</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Agregar Registro</ion-title>
    </ion-toolbar>
  </ion-header>

  <form (ngSubmit)="onSubmit()" #financeForm="ngForm">
    <ion-list [inset]="true">
      <ion-item class="rounded-input">
        <ion-label>Fecha del Registro</ion-label>
        <ion-datetime-button datetime="datetime"></ion-datetime-button>
      </ion-item>
      <ion-item class="rounded-input">
        <ion-input
          class="money-input"
          label="Ganancias del DÃ­a"
          labelPlacement="stacked"
          type="number"
          placeholder="1250.00"
          fill="outline"
          [required]="true"
          (ionInput)="handleInput($event, dailyEarnings)"
          [value]="dailyEarnings()">
            <div slot="start">$</div>
        </ion-input>
      </ion-item>
    </ion-list>
    
    <ion-modal [keepContentsMounted]="true">
      <ng-template>
        <ion-datetime 
          id="datetime"
          presentation="date"
          [showDefaultButtons]="true"
          (ionChange)="recordDate.set(($event.detail.value ?? '') + '')"
          [value]="recordDate()"
          done-text="Hecho"
          cancel-text="Cancelar"
          >
        </ion-datetime>
      </ng-template>
    </ion-modal>

    <ion-list [inset]="true">
      <ion-list-header>
        <ion-label>Egresos / Gastos</ion-label>
      </ion-list-header>
      <ion-item class="rounded-input">
        <ion-input label="Total de Gastos" labelPlacement="stacked" type="number" placeholder="Total" fill="outline" (ionInput)="handleInput($event, totalExpenses)" [value]="totalExpenses()"><div slot="start">$</div></ion-input>
      </ion-item>
    </ion-list>
    
    <ion-card class="ion-margin">
        <ion-card-content>
            <ion-item lines="none">
                <ion-label>Total de Egresos:</ion-label>
                <ion-text color="danger" slot="end">
                    <h2 class="ion-no-margin">${{ totalExpenses() | number:'1.2-2' }}</h2>
                </ion-text>
            </ion-item>
            <ion-item lines="none">
                <ion-label><strong>Beneficio Neto:</strong></ion-label>
                <ion-text [color]="netProfit() >= 0 ? 'success' : 'danger'" slot="end">
                    <h2 class="ion-no-margin">${{ netProfit() | number:'1.2-2' }}</h2>
                </ion-text>
            </ion-item>
        </ion-card-content>
    </ion-card>

    <div class="ion-padding">
       <ion-button 
        type="submit" 
        expand="block"
        [disabled]="dailyEarnings() === null || (dailyEarnings() ?? 0) < 0">
        Guardar Registro
      </ion-button>
    </div>
  </form>
</ion-content>